using NUnit.Framework;

namespace Day20_RaceCondition.Tests;

[TestFixture]
[TestOf(typeof(CheatFinder))]
public class CheatFinderTests
{

    [Test]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 2, 1 + 1 + 1 + 1 + 1 + 3 + 2 + 4 + 2 + 14 + 14)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 4, 1 + 1 + 1 + 1 + 1 + 3 + 2 + 4 + 2 + 14)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 6, 1 + 1 + 1 + 1 + 1 + 3 + 2 + 4 + 2)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 8, 1 + 1 + 1 + 1 + 1 + 3 + 2 + 4)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 10, 1 + 1 + 1 + 1 + 1 + 3 + 2)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 12, 1 + 1 + 1 + 1 + 1 + 3)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 20, 1 + 1 + 1 + 1 + 1)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 36, 1 + 1 + 1 + 1)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 38, 1 + 1 + 1)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 40, 1 + 1)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 64, 1)]
    public void Example_Tests(string input, int minimumTimeSaved, int expected) =>
        Assert.That(CheatFinder.FindCheatPositions(input, minimumTimeSaved, 2), Is.EqualTo(expected));

    [Test]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 50, 3 + 4 + 22 + 12 + 14 + 12 + 19 + 20 + 23 + 25 + 39 + 29 + 31 + 32)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 52, 3 + 4 + 22 + 12 + 14 + 12 + 19 + 20 + 23 + 25 + 39 + 29 + 31)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 54, 3 + 4 + 22 + 12 + 14 + 12 + 19 + 20 + 23 + 25 + 39 + 29)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 56, 3 + 4 + 22 + 12 + 14 + 12 + 19 + 20 + 23 + 25 + 39)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 58, 3 + 4 + 22 + 12 + 14 + 12 + 19 + 20 + 23 + 25)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 60, 3 + 4 + 22 + 12 + 14 + 12 + 19 + 20 + 23)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 62, 3 + 4 + 22 + 12 + 14 + 12 + 19 + 20)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 64, 3 + 4 + 22 + 12 + 14 + 12 + 19)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 66, 3 + 4 + 22 + 12 + 14 + 12)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 68, 3 + 4 + 22 + 12 + 14)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 70, 3 + 4 + 22 + 12)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 72, 3 + 4 + 22)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 74, 3 + 4)]
    [TestCase("""
              ###############
              #...#...#.....#
              #.#.#.#.#.###.#
              #S#...#.#.#...#
              #######.#.#.###
              #######.#.#...#
              #######.#.###.#
              ###..E#...#...#
              ###.#######.###
              #...###...#...#
              #.#####.#.###.#
              #.#...#.#.#...#
              #.#.#.#.#.#.###
              #...#...#...###
              ###############
              """, 76, 3)]
    public void Example_Tests_Part_2(string input, int minimumTimeSaved, int expected) =>
        Assert.That(CheatFinder.FindCheatPositions(input, minimumTimeSaved, 20), Is.EqualTo(expected));
}